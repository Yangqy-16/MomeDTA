_BASE_: lora_setting.yaml

CRITERION:
  NAME: InfoNCE
  TEMPERATURE: 0.1
  REDUCTION: mean
  USE_COSINE_SIMILARITY: True

DATALOADER:
  PIN_MEMORY: False
  DROP_LAST: False
  PERSISTENT_WORKERS: False

  TRAIN:
    BATCH_SIZE: 8
    NUM_WORKERS: 8

  VAL:
    BATCH_SIZE: 0  # If 0, it will be the same as TRAIN.BATCH_SIZE
    NUM_WORKERS: 0 # If 0, it will be the same as TRAIN.NUM_WORKERS

  TEST:
    BATCH_SIZE: 0  # If 0, it will be the same as TRAIN.BATCH_SIZE
    NUM_WORKERS: 0 # If 0, it will be the same as TRAIN.NUM_WORKERS

DATASET:
  NAME: DTADataset

  DF: /home/qingyuyang/test/data/pdbbind/all.csv
  FOLD: 0
  # TRAIN_DF: /home/qingyuyang/test/data/pdbbind/train.csv
  # VAL_DF: /home/qingyuyang/test/data/pdbbind/test.csv
  # TEST_DF: /home/qingyuyang/test/data/pdbbind/test.csv
  DATA_PATH: /home/qingyuyang/test/data/pdbbind

  MOL_MAX_LEN: 200
  PROT_MAX_LEN: 2000

MODEL:
  NAME: PretrainModel

  MOL1D:
    FINETUNE: True
  
  MOL3D:
    FINETUNE: True
  
  PROT1D:
    FINETUNE: True

  PROT3D:
    FINETUNE: True
  
  PROJECTION_DIM: 512
  ACTIVATION_FN: relu

MODULE:
  NAME: PretrainModule
  COMPILE: False

  OPTIMIZER:
    NAME: Adam
    LR: 0.0001
    BETA1: 0.9
    BETA2: 0.99
    WEIGHT_DECAY: 0.00001

  SCHEDULER:
    NAME: LinearWarmupCosineAnnealingLR
    WARMUP_EPOCH: 5
    MIN_LR: 0.0001
    WARMUP_START_LR: 0.00001

TRAINER:
  STRATEGY: deepspeed_stage_3        # Options: `auto`, `ddp`, `deepspeed_stage_2`, `deepspeed_stage_3` ...
  PRECISION: 16-mixed    # Options: `16-true`, `16-mixed`, `bf16-true`, `bf16-mixed`, `32-true`, `64-true`
  
  CHECKPOINT:
    EVERY_N_EPOCHS: 1
    SAVE_BEST: True    # If True, monitor will be required
    MONITOR: val_loss_epoch
    MONITOR_MODE: min   # Options: `min` or `max`

  MAX_EPOCHS: 100        # If profiler is enabled, this will be *automatically* set to 1
  NUM_SANITY_VAL_STEPS: 0
  LOG_EVERY_N_STEPS: 10
  ACCUMULATE_GRAD_BATCHES: 1

  CLIP_GRAD:
    ALGORITHM: norm
    VALUE: 1.0
  
  PATIENCE: 10

  DETERMINISTIC: False  # Set to True to enable cudnn.deterministic
  BENCHMARK: False      # Set to True to enable cudnn.benchmark
  PROFILER: null        # Set to `advanced` or `pytorch` to enable profiling
  DETECT_ANOMALY: False # Set to True to enable anomaly detection
  SYNC_BATCHNORM: False # Set to True to enable sync batchnorm

SEED: 42
OUTPUT_DIR: null
